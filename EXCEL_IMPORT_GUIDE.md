# 运动会网站Excel导入功能使用指南

## 功能概述

本系统支持通过Excel表格实时导入以下三类数据：

1. **比赛项目数据** - 包括项目名称、类型、年级等信息
2. **运动员数据** - 包括姓名、班级、年级、参赛项目等信息
3. **比赛时间安排** - 包括项目时间、地点、轮次等信息

## 使用方法

### 1. 访问管理后台

- 在网站首页点击右上角的"管理后台"按钮
- 或直接访问：`http://localhost:3000/admin`

### 2. 选择导入类型

管理后台提供三个标签页：
- **比赛项目导入** - 导入比赛项目基本信息
- **运动员数据导入** - 导入运动员个人信息和参赛项目
- **比赛时间安排导入** - 导入比赛的具体时间安排

### 3. 下载模板

每个导入类型都提供对应的Excel模板：
- 点击"下载模板"按钮获取标准格式的Excel文件
- 按照模板格式填写数据

### 4. 填写数据

#### 比赛项目模板格式：
| 项目名称 | 年级 | 类型(径赛/田赛) | 参赛人数 |
|----------|------|----------------|----------|
| 100米 | 高一 | 径赛 | 16 |
| 跳远 | 高二 | 田赛 | 12 |

#### 运动员数据模板格式：
| 姓名 | 班级 | 年级 | 参赛项目 |
|------|------|------|----------|
| 张三 | 高一1班 | 高一 | 100米,200米 |
| 李四 | 高二2班 | 高二 | 跳远,跳高 |

#### 比赛时间安排模板格式：
| 项目ID | 项目名称 | 日期 | 时间 | 地点 | 轮次 |
|--------|----------|------|------|------|------|
| 100m_g1 | 100米 | 2024-09-25 | 09:00 | 田径场 | 预赛 |
| longjump_g2 | 跳远 | 2024-09-25 | 10:30 | 沙坑 | 决赛 |

### 5. 上传文件

- 点击"选择文件"或拖拽Excel文件到上传区域
- 系统自动解析并显示数据预览
- 检查数据是否正确

### 6. 确认导入

- 点击"确认导入"按钮将数据导入系统
- 导入成功后数据立即生效
- 可以通过清空数据重新开始

## 数据验证规则

### 比赛项目验证：
- 项目名称不能为空
- 年级不能为空
- 类型必须是"径赛"或"田赛"
- 参赛人数必须是正整数

### 运动员数据验证：
- 姓名不能为空
- 班级不能为空
- 年级不能为空
- 参赛项目用逗号分隔

### 比赛时间安排验证：
- 项目ID不能为空
- 项目名称不能为空
- 日期格式：YYYY-MM-DD
- 时间不能为空
- 地点不能为空
- 轮次不能为空

## 注意事项

1. **数据备份**：导入前建议备份现有数据
2. **格式规范**：严格按照模板格式填写，避免格式错误
3. **数据量**：单次导入建议不超过1000条记录
4. **重复数据**：相同项目ID或运动员ID会被覆盖
5. **实时生效**：导入后数据立即在网站上显示

## 常见问题

### Q: 导入失败怎么办？
A: 检查错误提示，通常是格式问题。确保：
- 使用正确的模板格式
- 必填字段不为空
- 数据格式符合要求

### Q: 如何更新已有数据？
A: 重新导入同名项目或运动员数据，系统会自动更新

### Q: 支持哪些Excel格式？
A: 支持.xlsx和.xls格式，建议使用.xlsx格式

### Q: 如何批量删除数据？
A: 目前不支持批量删除，可以清空后重新导入

## 技术支持

如遇到问题，请联系系统管理员或查看浏览器控制台错误信息。